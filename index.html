<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600;800&display=swap" rel="stylesheet">

<style>

body{
font-family:'Poppins', sans-serif;
background:linear-gradient(135deg,#667eea,#764ba2);
color:white;
text-align:center;
margin:0;
}

.pointer{
width:0;
height:0;
border-left:18px solid transparent;
border-right:18px solid transparent;
border-top:35px solid white;
margin:20px auto -10px auto;
}

canvas{
border-radius:50%;
border:12px solid white;
box-shadow:0 20px 60px rgba(0,0,0,.4);
}

button{
margin-top:20px;
padding:14px 35px;
font-size:18px;
border:none;
border-radius:12px;
background:#00f5a0;
font-weight:600;
cursor:pointer;
}

#resultado{
font-size:64px;
margin-top:20px;
font-weight:800;
}

</style>
</head>

<body>

<h1>ðŸŽ‰ Personaliza tu Bingo ðŸŽ‰</h1>

<div class="pointer"></div>

<canvas id="wheel" width="500" height="500"></canvas>

<br>
<button onclick="spin()">GIRAR</button>

<div id="resultado"></div>

<script>

////////////////////////////////////////////////////

const palabras = [
"PERRO","GATO","CASA","AUTO","PLAYA",
"VIAJE","AMIGOS","FIESTA","CHILE","FUTBOL"
];

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const radius = canvas.width/2;

let rotation = 0;
let girando = false;

////////////////////////////////////////////////////

function color(i){
const hue = Math.floor((360/palabras.length)*i);
return `hsl(${hue},75%,60%)`;
}

////////////////////////////////////////////////////
// DIBUJAR RULETA
////////////////////////////////////////////////////

function drawWheel(rotDeg=0){

ctx.setTransform(1,0,0,1,0,0);
ctx.clearRect(0,0,canvas.width,canvas.height);

ctx.translate(radius,radius);
ctx.rotate(rotDeg*Math.PI/180);
ctx.translate(-radius,-radius);

const angle = (2*Math.PI)/palabras.length;

palabras.forEach((p,i)=>{

const start=i*angle;
const end=start+angle;

ctx.beginPath();
ctx.moveTo(radius,radius);
ctx.arc(radius,radius,radius,start,end);
ctx.fillStyle=color(i);
ctx.fill();

ctx.save();

ctx.translate(radius,radius);
ctx.rotate(start+angle/2);

ctx.textAlign="right";
ctx.fillStyle="#fff";
ctx.font="bold 20px Poppins";

ctx.fillText(p,radius-15,7);

ctx.restore();

});
}

drawWheel();

////////////////////////////////////////////////////
// SPIN PERFECTO (SIN DRIFT)
////////////////////////////////////////////////////

function spin(){

if(girando) return;
girando=true;

// normalizar rotaciÃ³n SIEMPRE
rotation = rotation % 360;

const slice = 360/palabras.length;
const index = Math.floor(Math.random()*palabras.length);

// centro del ganador
const winnerAngle = index*slice + slice/2;

// flecha arriba
const pointer = 270;

// cuÃ¡nto falta para alinear DESDE la rotaciÃ³n actual
let delta = pointer - (winnerAngle + rotation);

// evitar giros hacia atrÃ¡s
if(delta < 0) delta += 360;

// giros largos
const spins = 6 + Math.random()*4;

const finalRotation = rotation + spins*360 + delta;

let start=null;
const duration=5000;

function animate(ts){

if(!start) start=ts;

let progress=ts-start;
let t=progress/duration;

// easing tipo casino
let ease=1-Math.pow(1-t,5);

let current=rotation+(finalRotation-rotation)*ease;

drawWheel(current);

if(progress<duration){

requestAnimationFrame(animate);

}else{

rotation = finalRotation % 360;

document.getElementById("resultado").innerText=
palabras[index];

girando=false;
}
}

requestAnimationFrame(animate);
}

</script>

</body>
</html>
